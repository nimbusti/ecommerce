<polymer-element name="cart-model">
<template>
	<core-signals on-core-signal-addtocart="{{addtocartSignal}}"></core-signals>
	<core-localstorage id="storage" name="cart" value="{{mycart}}"></core-localstorage>
</template>
  <script>
    Polymer('cart-model', {
		attached: function() {
			this.$.storage.value = {"total": 0.00, "nitems": 0, "items": []};
			this.$.storage.save();
		},
		addtocartSignal: function(e, detail, sender) {
			this.$.storage.load();
			var cart = this.$.storage.value;
			cart.total += detail.price;
			cart.nitems++;
			this.$.storage.value = cart;
			this.fire('core-signal', {name: "cartchanged", data: {  }});
		}
    });
  </script>
</polymer-element>
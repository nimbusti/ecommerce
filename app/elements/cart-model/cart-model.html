<polymer-element name="cart-model">
<template>
	<core-signals on-core-signal-addtocart="{{addtocartSignal}}"></core-signals>
	<core-localstorage id="storage" name="cart" value="{{mycart}}"></core-localstorage>
</template>
  <script>
    Polymer('cart-model', {
		ready: function() {
			this.$.storage.load();
			var cart = this.$.storage.value;
			if(!cart) {
				var cartContent = [
								  { SKU: "001", title: "Cafeteira Xp 10 Krups", price: "189.90", quantity: 2},
								  { SKU: "002", title: "Torradeira Inox", price: "189.90", quantity: 2}
								  ];
				this.$.storage.value = cartContent;
				this.$.storage.save();
			}
		},
		addtocartSignal: function(e, detail, sender) {
			
			this.$.storage.load();
			var cart = this.$.storage.value;
			var newItem = { SKU: detail.SKU, title: detail.title, price: detail.price, quantity: detail.quantity};
			cart.push(newItem);
			this.$.storage.value = cart;
			this.$.storage.save();
			this.fire('core-signal', {name: "cartchanged", data: {  }});
		}
    });
  </script>
</polymer-element>
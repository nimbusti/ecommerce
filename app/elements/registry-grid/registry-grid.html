
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-up.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/list-cascade.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/cascade-transition.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/cross-fade.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/hero-transition.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/scale-up.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-down.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">

<polymer-element name="registry-grid" attributes="registries registry">
  <template>
    <link rel="stylesheet" href="registry-grid.css">

      <core-animated-pages flex selected="{{page}}" transitions="hero-transition list-cascade cascade-transition slide-up list-cascade cross-fade" on-core-animated-pages-transition-end="{{complete}}">

          <section>

              <div class="tile-container" layout flex horizontal wrap center-justified>
                  <template repeat="{{item in registries}}">
                      <div class="card-container">
                          <div class="card" layout flex center  on-tap="{{transition}}">
                              <span cross-fade>
                                  <registry-card hero-id="item-{{item.index}}" hero event="[[item]]"></registry-card>
                              </span>
                          </div>
                      </div>
                  </template>
              </div>
          </section>

          <section>

              <div class="top" hero-id="item-{{itemSelected.index}}" hero cross-fase>
                  <div class="top-image">
                          <img src="{{itemSelected.image}}" alt="foto">
                  </div>
              </div>
              <div class="bottom theme-bg-a" hero-id="footer" hero cross-fade>
                  <span cross-fade><p>{{itemSelected.name}}</p></span>
              </div>
              <div cross-fade>
                  <span cross-fade><p class="message">{{itemSelected.message}}</p></span>
                  <div class="message" style="text-align: center;">
                      <paper-button id="facebook" icon="social:post-facebook"></paper-button>
                      <paper-button id="twitter" icon="social:post-twitter"></paper-button>
                      <paper-button id="tumblr" icon="social:post-tumblr"></paper-button>
                  </div>
              </div>
              <div class="fab fab-0" hero-id="fab" hero>
                  <paper-fab class="theme-bg-b" icon="av:play-arrow" on-tap="{{transition}}" hero></paper-fab>
              </div>
          </section>

          <section layout vertical>

              <div class="tall-toolbar theme-bg-a" hero-id="footer" hero layout horizontal cross-fade>
                      <img class="image-circle" src={{itemSelected.image}}>
                  <p>{{itemSelected.name}}</p>
              </div>
              <div class="fab fab-1" hero-id="fab" hero>
                  <paper-fab class="theme-bg-b" icon="favorite" on-tap="{{transition}}" hero></paper-fab>
              </div>

              <div slide-up list-cascade flex>
              <template repeat="{{product in itemSelected.items}}">
                    <paper-item iconSrc={{product.image}} label={{product.title}}></paper-item>
              </template>
              </div>
<!--              <div flex class="middle" slide-up list-cascade>
                  <template layout horizontal repeat="{{product in itemSelected.items}}">
                      <img class="image-square" src={{product.image}}>
                      <p>{{product.title}}</p>
                  </template>
              </div>-->

              <div class="footer" layout horizontal slide-up>
                  <div class="avatar"></div>
                  <div class="footer-right" flex>

                  </div>
                  <div class="score">

                  </div>
              </div>

          </section>

      </core-animated-pages>

  </template>
  <script>
      Polymer('registry-grid',{
          page: 0,

          itemSelected:{},

          transition: function(event, detail, sender) {

              if (this.page === 2) {
                  this.page = 0;
              } else {
                  if(event.target.templateInstance.model.item){
                      this.itemSelected = event.target.templateInstance.model.item;
                  }
                  this.page += 1;
              }
          },
          transitionend: function() {
              if (this.lastSelected) {
                  this.lastSelected = null;
              }
          },
          back: function() {
              this.lastSelected = this.$.pages.selected;
              this.$.pages.selected = 0;
          },
          selectView: function(e) {
              var i = e.target.templateInstance.model.item.index;
              this.$.pages.selected = i+1;
          },
          filterList: function (e, u, input) {
              var value = input.inputValue;

              function hasValue (o) {
                  return o.name.toLowerCase().indexOf(value.toLowerCase()) > -1;
              }

              this.fitems = this.items.filter(hasValue);
              var numResults = this.fitems.length;
              this.$.filter.invalid = !numResults;
          }


      });
  </script>
</polymer-element>

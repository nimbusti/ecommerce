
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-up.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/list-cascade.html">


<polymer-element name="registry-grid" attributes="registries">
  <template>
    <link rel="stylesheet" href="registry-grid.css">


      <core-animated-pages flex selected="{{page}}" transitions="hero-transition slide-up list-cascade cross-fade" on-core-animated-pages-transition-end="{{complete}}">

          <section>

              <div class="tile-container" layout flex horizontal wrap center-justified>
                  <template repeat="{{item in registries}}">
                      <div class="card-container">
                          <div class="card" layout flex center hero-id="item-{{item.index}}" hero on-tap="{{transition}}">
                              <span cross-fade>
                                  <registry-card event="[[item]]"></registry-card>
                              </span>
                          </div>
                      </div>
                  </template>
              </div>
          </section>

          <section>

              <div class="top" hero-id="item-{{itemSelected.index}}" hero>
                  <div class="top-image" cross-fade>
                          <img src="{{itemSelected.image}}" alt="foto">
                  </div>
              </div>
              <div class="bottom" hero-id="item-{{itemSelected.index}}" hero cross-fade>
                  <span cross-fade><p>{{itemSelected.name}}</p></span>
              </div>
              <div hero-id="item-{{itemSelected.index}}" hero cross-fade>
                  <span cross-fade><p class="message">{{itemSelected.message}}</p></span>
                  <paper-button id="facebook" icon="social:post-facebook"></paper-button>
                  <paper-button id="twitter" icon="social:post-twitter"></paper-button>
                  <paper-button id="tumblr" icon="social:post-tumblr"></paper-button>
              </div>
              <div class="fab fab-0" hero-id="fab" hero>
                  <paper-fab icon="av:play-arrow" on-tap="{{transition}}" hero></paper-fab>
              </div>
          </section>

          <section layout vertical>

              <div class="tall-toolbar questions" hero-id="item-{{itemSelected.index}}" hero>
                  <span cross-fade>Question here</span>
              </div>
              <div class="fab fab-1" hero-id="fab" hero>
                  <paper-fab icon="favorite" on-tap="{{transition}}" hero></paper-fab>
              </div>

              <div flex class="middle" slide-up list-cascade>
                  <p>Option 1</p>
                  <p>Option 2</p>
                  <p>Option 3</p>
                  <p>Option 4</p>
                  <p>Option 5</p>
              </div>

              <div class="footer" layout horizontal slide-up>
                  <div class="avatar"></div>
                  <div class="footer-right" flex>
                      some text here
                  </div>
                  <div class="score">
                      32 pts
                  </div>
              </div>

          </section>

      </core-animated-pages>

  </template>
  <script>
      Polymer('registry-grid',{
          page: 0,

          itemSelected:{},

          transition: function(event, detail, sender) {

              this.itemSelected = event.target.templateInstance.model.item;
              console.log("Clicked " + this.itemSelected);

              if (this.page === 2) {
                  this.page = 0;
              } else {
                  this.page += 1;
              }
          },
          transitionend: function() {
              if (this.lastSelected) {
                  this.lastSelected = null;
              }
          },
          back: function() {
              this.lastSelected = this.$.pages.selected;
              this.$.pages.selected = 0;
          },
          selectView: function(e) {
              var i = e.target.templateInstance.model.item.index;
              this.$.pages.selected = i+1;
          },
          filterList: function (e, u, input) {
              var value = input.inputValue;

              function hasValue (o) {
                  return o.name.toLowerCase().indexOf(value.toLowerCase()) > -1;
              }

              this.fitems = this.items.filter(hasValue);
              var numResults = this.fitems.length;
              this.$.filter.invalid = !numResults;
          }


      });
  </script>
</polymer-element>
